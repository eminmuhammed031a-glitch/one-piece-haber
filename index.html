<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>One Piece Haber | Yeni D√ºnya</title>
    <link rel="icon" href="https://static.wikia.nocookie.net/onepiece/images/c/c5/Revolutionary_Army_Jolly_Roger.png" type="image/png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pirata+One&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

    <style>
        /* --- CSS AYARLARI --- */
        :root { --bg-paper: #f4e4bc; --bg-dark: #2c241b; --ocean-blue: #006994; --luffy-red: #d62828; --gold: #ffb703; --text-main: #3e2723; --font-heading: 'Pirata One', cursive; --font-body: 'Roboto', sans-serif; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background-color: var(--bg-paper); color: var(--text-main); font-family: var(--font-body); line-height: 1.6; background-image: radial-gradient(#e6d5a8 15%, transparent 16%), radial-gradient(#e6d5a8 15%, transparent 16%); background-size: 60px 60px; background-position: 0 0, 30px 30px; padding-bottom: 50px; }
        header { background-color: var(--bg-dark); color: var(--gold); padding: 1rem 2rem; position: sticky; top: 0; z-index: 1000; box-shadow: 0 4px 12px rgba(0,0,0,0.5); display: flex; justify-content: space-between; align-items: center; border-bottom: 4px solid var(--luffy-red); }
        .logo { font-family: var(--font-heading); font-size: 2rem; display: flex; align-items: center; gap: 10px; cursor: pointer; letter-spacing: 2px; }
        nav ul { display: flex; list-style: none; gap: 20px; align-items: center; }
        nav a { color: #fdf5e6; text-decoration: none; font-weight: bold; font-size: 1.1rem; transition: 0.3s; text-transform: uppercase; }
        nav a:hover { color: var(--gold); text-shadow: 0 0 5px var(--gold); }
        .login-btn { background: var(--luffy-red); color: white; padding: 5px 15px; border-radius: 5px; cursor: pointer; border: 2px solid white; font-family: var(--font-heading); font-size: 1.2rem; }
        .user-profile-mini { display: flex; align-items: center; gap: 10px; cursor: pointer; background: rgba(255,255,255,0.1); padding: 5px 10px; border-radius: 20px; transition: 0.3s; border: 1px solid var(--gold); }
        .user-profile-mini:hover { background: rgba(255,255,255,0.2); transform: scale(1.05); }
        .user-avatar-small { width: 40px; height: 40px; border-radius: 50%; border: 2px solid var(--gold); background: white; object-fit: cover; }
        section { padding: 4rem 2rem; max-width: 1200px; margin: 0 auto; }
        .section-title { font-family: var(--font-heading); font-size: 3rem; text-align: center; margin-bottom: 3rem; color: var(--bg-dark); text-shadow: 2px 2px 0px rgba(255,255,255,0.4); border-bottom: 2px solid var(--luffy-red); display: inline-block; left: 50%; position: relative; transform: translateX(-50%); }
        .news-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; }
        .news-card { background: #fff; border: 2px solid var(--bg-dark); border-radius: 8px; overflow: hidden; display: flex; flex-direction: column; transition: transform 0.3s; box-shadow: 5px 5px 0 rgba(0,0,0,0.2); height: 100%; }
        .news-card:hover { transform: translateY(-5px); box-shadow: 8px 8px 0 rgba(0,0,0,0.3); }
        .news-img-placeholder { height: 180px; display: flex; align-items: center; justify-content: center; color: white; font-family: var(--font-heading); font-size: 2.5rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.8); background-size: cover; background-position: center; }
        .news-content { padding: 1.5rem; flex-grow: 1; display: flex; flex-direction: column; }
        .tag { display: inline-block; background: var(--bg-dark); color: var(--gold); padding: 4px 8px; font-size: 0.75rem; border-radius: 4px; margin-bottom: 10px; width: fit-content; font-weight: bold;}
        .news-content h3 { font-family: var(--font-heading); font-size: 1.6rem; color: var(--luffy-red); margin-bottom: 0.8rem; line-height: 1.1; }
        .news-content p { font-size: 0.95rem; color: #444; margin-bottom: 1.5rem; flex-grow: 1; }
        .read-more { text-align: center; background: var(--ocean-blue); color: white; padding: 8px; border-radius: 4px; font-weight: bold; cursor: pointer; transition: 0.2s; margin-top: auto; }
        .read-more:hover { background: var(--bg-dark); }
        .games-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .game-item { background: #fff; padding: 15px; border-radius: 8px; border: 1px solid var(--text-main); display: flex; flex-direction: column; gap: 10px; transition: 0.3s; }
        .game-item:hover { transform: translateY(-3px); box-shadow: 0 5px 10px rgba(0,0,0,0.1); }
        .game-header { display: flex; justify-content: space-between; align-items: center; }
        .game-title { font-family: var(--font-heading); font-size: 1.4rem; color: var(--ocean-blue); }
        .game-platform { font-size: 0.75rem; font-weight: bold; padding: 2px 6px; border-radius: 4px; color: white; }
        .plat-mobile { background: #e67e22; }
        .plat-roblox { background: #e74c3c; }
        #quiz-game { background: rgba(255, 255, 255, 0.6); border-radius: 20px; border: 3px dashed var(--bg-dark); padding: 2rem; margin-top: 2rem; }
        .quiz-container { max-width: 800px; margin: 0 auto; text-align: center; }
        .quiz-question { font-size: 1.5rem; font-weight: bold; margin-bottom: 20px; color: var(--bg-dark); }
        .quiz-options { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .quiz-btn { padding: 15px; background: var(--bg-dark); color: var(--gold); border: none; border-radius: 8px; cursor: pointer; font-size: 1.1rem; transition: 0.2s; font-family: var(--font-body); }
        .quiz-btn:hover { background: var(--luffy-red); color: white; transform: scale(1.02); }
        .quiz-score { font-family: var(--font-heading); font-size: 2rem; margin-top: 20px; color: var(--ocean-blue); }
        .feedback { margin-top: 15px; font-weight: bold; min-height: 30px; }
        #fruit-game { text-align: center; margin-top: 3rem; border-top: 2px solid var(--luffy-red); padding-top: 2rem; }
        .fruit-box { background: #fff; border: 4px double var(--bg-dark); width: 300px; height: 300px; margin: 20px auto; display: flex; flex-direction: column; justify-content: center; align-items: center; border-radius: 50%; box-shadow: 0 0 20px rgba(0,0,0,0.2); transition: 0.5s; position: relative;}
        .fruit-name { font-family: var(--font-heading); font-size: 2rem; color: var(--luffy-red); margin-bottom: 10px; }
        .fruit-type { background: var(--gold); color: var(--bg-dark); padding: 2px 10px; border-radius: 20px; font-weight: bold; font-size: 0.9rem;}
        .fruit-desc { font-size: 0.9rem; padding: 10px; color: #555; }
        .fruit-chance { position: absolute; bottom: 30px; font-size: 0.8rem; color: #999; }
        .spin-btn { padding: 10px 30px; background: var(--ocean-blue); color: white; border: none; font-size: 1.2rem; border-radius: 50px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 0 #003049; }
        .spin-btn:active { transform: translateY(4px); box-shadow: none; }
        .spin-limit { margin-top: 10px; font-size: 0.9rem; color: #555; }
        #leaderboard { background: #fff; border: 2px solid var(--bg-dark); border-radius: 10px; padding: 2rem; max-width: 800px; margin: 3rem auto; }
        .rank-table { width: 100%; border-collapse: collapse; }
        .rank-table th { background: var(--bg-dark); color: var(--gold); padding: 10px; text-align: left; }
        .rank-table td { padding: 10px; border-bottom: 1px solid #ddd; }
        .current-user-row { background: #e3f2fd; font-weight: bold; border: 2px solid var(--ocean-blue); }
        #countdown-section { background-color: var(--bg-dark); color: #fff; margin-top: 4rem; border-radius: 10px; text-align: center; border-top: 5px solid var(--gold); padding-bottom: 3rem; }
        #countdown-section .section-title { color: var(--gold); border-bottom: none; text-shadow: none; }
        .timers-wrapper { display: flex; justify-content: center; flex-wrap: wrap; gap: 2rem; }
        .timer-box { background: rgba(255,255,255,0.05); padding: 2rem; border-radius: 10px; min-width: 250px; border: 1px solid rgba(255,255,255,0.1); }
        .timer-title { color: var(--ocean-blue); font-weight: bold; font-size: 1.2rem; margin-bottom: 10px; text-transform: uppercase; }
        .timer-display { font-family: monospace; font-size: 1.5rem; color: var(--gold); font-weight: bold; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; justify-content: center; align-items: center; z-index: 2000; backdrop-filter: blur(5px); }
        .modal-content { background: var(--bg-paper); padding: 2rem; border-radius: 10px; max-width: 800px; width: 90%; position: relative; border: 4px solid var(--bg-dark); max-height: 80vh; overflow-y: auto; box-shadow: 0 0 50px rgba(0,0,0,0.5); }
        .close-modal { position: absolute; top: 10px; right: 20px; font-size: 2.5rem; cursor: pointer; color: var(--luffy-red); font-weight: bold; }
        .modal-body h2 { font-family: var(--font-heading); margin-bottom: 1rem; color: var(--bg-dark); border-bottom: 2px solid var(--luffy-red); }
        .modal-body h3 { font-family: var(--font-heading); margin-top: 1.5rem; color: var(--ocean-blue); }
        .modal-body ul { padding-left: 20px; }
        .modal-body li { margin-bottom: 5px; color: #333; }
        .modal-body p { margin-bottom: 1rem; color: #333; font-size: 1rem; }
        .sbs-item { margin-bottom: 20px; border-bottom: 1px dashed #ccc; padding-bottom: 10px; }
        .sbs-q { font-weight: bold; color: var(--ocean-blue); display: block; margin-bottom: 5px; }
        .sbs-q::before { content: 'S: '; color: var(--text-main); }
        .sbs-a { font-style: italic; margin-left: 15px; display: block; }
        .sbs-a::before { content: 'O: '; font-weight: bold; font-style: normal; }
        .auth-form input, .auth-form textarea { width: 100%; padding: 10px; margin-bottom: 15px; border: 2px solid var(--bg-dark); border-radius: 5px; font-family: var(--font-body); }
        .auth-form label { font-weight: bold; display: block; margin-bottom: 5px; color: var(--bg-dark); }
        .auth-btn { width: 100%; padding: 12px; background: var(--luffy-red); color: white; border: none; font-weight: bold; cursor: pointer; font-size: 1.1rem; margin-top: 10px; transition: 0.3s;}
        .auth-btn:hover { background: #b71c1c; }
        .auth-toggle { display: flex; gap: 10px; margin-bottom: 20px; }
        .auth-toggle button { flex: 1; padding: 10px; background: #ddd; border: none; cursor: pointer; font-weight: bold; }
        .auth-toggle button.active { background: var(--ocean-blue); color: white; }
        .wanted-poster { background: #fff; border: 5px solid #5a4a3a; padding: 20px; text-align: center; max-width: 350px; margin: 0 auto; box-shadow: 5px 5px 15px rgba(0,0,0,0.3); position: relative; }
        .wanted-header { font-family: serif; font-size: 2.5rem; letter-spacing: 5px; color: #5a4a3a; margin-bottom: 10px; }
        .wanted-img { width: 100%; height: 250px; object-fit: cover; background: #ccc; border: 2px solid #5a4a3a; }
        .wanted-name { font-family: var(--font-heading); font-size: 2rem; text-transform: uppercase; margin: 10px 0; line-height: 1; }
        .wanted-bounty { font-family: serif; font-size: 1.2rem; color: #5a4a3a; border-top: 2px solid #5a4a3a; padding-top: 5px; }
        .bounty-amount { font-family: var(--font-heading); font-size: 2rem; color: #5a4a3a; }
        .bio-text { font-size: 0.9rem; color: #555; margin-top: 10px; font-style: italic; white-space: pre-wrap; }
        .friend-list { margin-top: 15px; text-align: left; border-top: 1px solid #ccc; padding-top: 10px; }
        .friend-list ul { list-style: none; padding: 0; max-height: 150px; overflow-y: auto; }
        .friend-list li { background: #f0f0f0; margin-bottom: 5px; padding: 5px; border-radius: 5px; font-size: 0.9rem; cursor: pointer; transition: 0.2s; display: flex; align-items: center; gap: 5px;}
        .friend-list li:hover { background: #e0e0e0; }
        .friend-actions { margin-left: auto; display: flex; gap: 5px; }
        .btn-tiny { padding: 2px 6px; font-size: 0.7rem; border: none; border-radius: 4px; cursor: pointer; color: white;}
        .btn-accept { background: green; } .btn-decline { background: red; } .btn-remove { background: #555; }
        .fruit-badge { background: var(--gold); color: black; font-size: 0.8rem; padding: 3px 8px; border-radius: 10px; font-weight: bold; display: inline-block; margin-top: 5px;}
        footer { text-align: center; margin-top: 50px; color: #666; font-size: 0.9rem; }
        @media (max-width: 768px) { header { flex-direction: column; gap: 10px; } .quiz-options { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <header>
        <div class="logo">‚ò†Ô∏è ONE PIECE HABER</div>
        <nav>
            <ul>
                <li><a href="#news">Haberler</a></li>
                <li><a href="#leaderboard">Sƒ±ralama</a></li>
                <li><a href="#quiz-game">Test</a></li>
                <li><a href="#fruit-game">√áark</a></li>
                <li id="auth-section">
                    <button class="login-btn" onclick="openLoginModal()">Giri≈ü / Kayƒ±t</button>
                </li>
            </ul>
        </nav>
    </header>

    <section id="news">
        <h2 class="section-title">Grand Line'dan Son Dakika</h2>
        <div class="news-grid">
            <article class="news-card">
                <div class="news-img-placeholder" style="background: linear-gradient(135deg, #d62828, #333);">ELBAF</div>
                <div class="news-content">
                    <span class="tag">Manga Spoiler</span>
                    <h3>B√∂l√ºm 1174 ve "B√ºy√ºk Mola"</h3>
                    <p>Manga ≈üu an Elbaf Arkƒ±'nƒ±n zirvesinde. 1174. B√∂l√ºm'√ºn yarƒ±n yayƒ±nlanmasƒ± bekleniyor.</p>
                    <div class="read-more" onclick="openModal('manga')">√ñzeti Oku</div>
                </div>
            </article>
            <article class="news-card">
                <div class="news-img-placeholder" style="background: linear-gradient(135deg, #006994, #222);">SBS</div>
                <div class="news-content">
                    <span class="tag">SBS √ñzel</span>
                    <h3>Karakter Sƒ±rlarƒ±</h3>
                    <p>Oda-sensei'den ≈üok cevaplar! Banyo yapma sƒ±klƒ±klarƒ±, karakterlerin ger√ßek hayattaki √ºlkeleri...</p>
                    <div class="read-more" onclick="openModal('sbs')">Tamamƒ±nƒ± Oku</div>
                </div>
            </article>
            <article class="news-card">
                <div class="news-img-placeholder" style="background: linear-gradient(135deg, #ffb703, #222);">ANIME</div>
                <div class="news-content">
                    <span class="tag">Anime</span>
                    <h3>Anime D√∂n√º≈ü√º</h3>
                    <p>Nisan ayƒ±nda Elbaf Arc ba≈ülƒ±yor! Wit Studio'nun "The One Piece" remake projesi sessizliƒüini koruyor.</p>
                    <div class="read-more" onclick="openModal('anime')">Detaylar</div>
                </div>
            </article>
        </div>
    </section>

    <section id="leaderboard">
        <h2 class="section-title">D√ºnya Sƒ±ralamasƒ± (Top 50)</h2>
        <p style="text-align:center; margin-bottom:10px;">Sadece ger√ßek korsanlar (giri≈ü yapanlar) burada listelenir.</p>
        <div style="overflow-x:auto;">
            <table class="rank-table">
                <thead><tr><th>#</th><th>Korsan Adƒ±</th><th>√ñd√ºl (Bounty)</th><th>Meyve</th></tr></thead>
                <tbody id="leaderboard-body">
                    <tr><td colspan="4" style="text-align:center;">Veritabanƒ±na baƒülanƒ±yor...</td></tr>
                </tbody>
            </table>
        </div>
    </section>

    <section id="games">
        <h2 class="section-title">Korsan Oyunlarƒ±</h2>
        <div class="games-grid">
            <div class="game-item"><div class="game-header"><span class="game-title">OP: Bounty Rush</span><span class="game-platform plat-mobile">Mobil</span></div><p>4v4 Bayrak kapma oyunu. Yeni Elbaf karakterleri metayƒ± sallƒ±yor.</p></div>
            <div class="game-item"><div class="game-header"><span class="game-title">Project: Fighter</span><span class="game-platform plat-mobile">Mobil</span></div><p>Tencent yapƒ±mƒ±, inanƒ±lmaz grafikli d√∂v√º≈ü oyunu.</p></div>
            <div class="game-item" style="border-color: #e74c3c;"><div class="game-header"><span class="game-title">Blox Fruits</span><span class="game-platform plat-roblox">Roblox</span></div><p>Roblox'un en pop√ºleri. Yeni Kitsune meyvesi ve Dragon rework g√ºndemde.</p></div>
            <div class="game-item" style="border-color: #e74c3c;"><div class="game-header"><span class="game-title">King Legacy</span><span class="game-platform plat-roblox">Roblox</span></div><p>Yeni boss raidleri ile oyuncu sayƒ±sƒ±nƒ± artƒ±rdƒ±. Grind sevenler i√ßin.</p></div>
            <div class="game-item" style="border-color: #e74c3c;"><div class="game-header"><span class="game-title">Fruit Battlegrounds</span><span class="game-platform plat-roblox">Roblox</span></div><p>Tamamen PVP odaklƒ±. Nika meyvesini uyandƒ±rmak i√ßin sava≈ü.</p></div>
        </div>
    </section>

    <section id="quiz-game">
        <h2 class="section-title">Grand Line Bilgi Yarƒ±≈ümasƒ±</h2>
        <div class="quiz-container">
            <div class="quiz-score">Kazanƒ±lan Bounty: <span id="current-score" style="color:var(--luffy-red)">0</span> ‡∏ø</div>
            <p style="margin-bottom:20px; color:#666;">40 sorudan rastgele 10 tanesi sorulur!</p>
            <div id="quiz-box">
                <div class="quiz-question" id="question-text">Soru Y√ºkleniyor...</div>
                <div class="quiz-options">
                    <button class="quiz-btn" onclick="checkAnswer(0)">A</button><button class="quiz-btn" onclick="checkAnswer(1)">B</button>
                    <button class="quiz-btn" onclick="checkAnswer(2)">C</button><button class="quiz-btn" onclick="checkAnswer(3)">D</button>
                </div>
                <div class="feedback" id="feedback-text"></div>
            </div>
        </div>
    </section>

    <section id="fruit-game">
        <h2 class="section-title">≈ûeytan Meyveni Ke≈üfet</h2>
        <p>Dikkat! Yeni meyve √ßƒ±karsa eskisinin puanƒ± silinir, yenisi eklenir!</p>
        <div class="fruit-box" id="fruit-display">
            <div class="fruit-name">?</div>
            <div class="fruit-desc">√áevirmek i√ßin butona bas!</div>
        </div>
        <button class="spin-btn" onclick="spinFruit()">√áarkƒ± √áevir</button>
        <div class="spin-limit">Kalan Hakkƒ±n: <span id="spin-count">3</span></div>
    </section>

    <section id="countdown-section">
        <h2 class="section-title">Geri Sayƒ±m</h2>
        <div class="timers-wrapper">
            <div class="timer-box"><div class="timer-title">Manga 1175</div><div class="timer-display" id="manga-timer">...</div><small>Tahmini Per≈üembe</small></div>
            <div class="timer-box"><div class="timer-title">Live Action S2</div><div class="timer-display" id="la-timer">...</div><small>10 Mart 2026</small></div>
            <div class="timer-box"><div class="timer-title">Anime Yeni Sezon</div><div class="timer-display" id="anime-timer">Hesaplanƒ±yor...</div><small>Nisan 2026</small></div>
        </div>
    </section>

    <footer><p>&copy; 2026 One Piece Haber. Fan Yapƒ±mƒ±dƒ±r.</p></footer>

    <div class="modal-overlay" id="infoModal"><div class="modal-content"><span class="close-modal" onclick="closeModal('infoModal')">√ó</span><div class="modal-body" id="modalBody"></div></div></div>
    
    <div class="modal-overlay" id="loginModal">
        <div class="modal-content" style="max-width: 450px;">
            <span class="close-modal" onclick="closeModal('loginModal')">√ó</span>
            <h2 style="text-align: center; font-family: var(--font-heading);">Korsan Pasaportu</h2>
            <div class="auth-toggle">
                <button id="btn-show-login" class="active" onclick="switchAuthMode('login')">Giri≈ü Yap</button>
                <button id="btn-show-register" onclick="switchAuthMode('register')">Kayƒ±t Ol</button>
            </div>
            
            <div id="login-form" class="auth-form">
                <label>Kullanƒ±cƒ± Adƒ±:</label><input type="text" id="login-name" placeholder="Adƒ±n...">
                <label>≈ûifre:</label><input type="password" id="login-pass" placeholder="≈ûifren...">
                <button class="auth-btn" onclick="performLogin()">Giri≈ü Yap</button>
            </div>

            <div id="register-form" class="auth-form" style="display:none;">
                <label>Kullanƒ±cƒ± Adƒ± Belirle:</label><input type="text" id="reg-name" placeholder="Yeni korsan adƒ±...">
                <label>≈ûifre Belirle:</label><input type="password" id="reg-pass" placeholder="G√º√ßl√º bir ≈üifre...">
                <label>Hakkƒ±nda:</label><textarea id="reg-bio" rows="2" placeholder="√ñrn: Geleceƒüin Korsanlar Kralƒ±"></textarea>
                <label>Profil Resmi (Cihazƒ±ndan):</label><input type="file" id="reg-file" accept="image/*" onchange="previewImage()">
                <div style="text-align:center;"><img id="img-preview" src="https://static.wikia.nocookie.net/onepiece/images/c/c5/Revolutionary_Army_Jolly_Roger.png" style="width:80px;height:80px;border-radius:50%;display:none;margin:10px auto;border:2px solid #333;object-fit:cover;"></div>
                <button class="auth-btn" onclick="performRegister()">Kayƒ±t Ol</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="profileModal">
        <div class="modal-content" style="max-width: 400px; background: transparent; box-shadow: none; border: none;">
            <span class="close-modal" onclick="closeModal('profileModal')" style="color: white; z-index: 2001;">√ó</span>
            <div class="wanted-poster">
                <div class="wanted-header">WANTED</div><div style="font-size:0.8rem;">DEAD OR ALIVE</div>
                <img id="profile-img" class="wanted-img" src=""><div id="profile-name" class="wanted-name"></div>
                <div class="wanted-bounty">‡∏ø <span id="profile-bounty" class="bounty-amount"></span> -</div>
                <div id="profile-fruit" class="fruit-badge" style="display:none;"></div>
                <p id="profile-bio" class="bio-text"></p>
                
                <div class="friend-list">
                    <strong>Gelen ƒ∞stekler:</strong>
                    <ul id="request-ul" style="border-bottom:1px dashed #5a4a3a; margin-bottom:10px; padding-bottom:5px;"></ul>
                    
                    <strong>Tayfam (Arkada≈ü Ekle):</strong>
                    <div style="display:flex; gap:5px; margin-bottom:5px;"><input type="text" id="friend-input" placeholder="ƒ∞sim Gir..." style="width:70%;padding:5px;"><button onclick="sendFriendRequest()" style="padding:5px;cursor:pointer;">EKLE</button></div>
                    <ul id="friend-ul"></ul>
                </div>
            </div>
            <button onclick="enableEdit()" style="width:100%;margin-top:10px;padding:10px;background:#006994;color:white;border:none;cursor:pointer;font-weight:bold;">Profili D√ºzenle</button>
            <button onclick="performLogout()" style="width:100%;margin-top:5px;padding:10px;background:#333;color:white;border:none;cursor:pointer;font-weight:bold;">√áƒ±kƒ±≈ü Yap</button>
        </div>
    </div>

    <div class="modal-overlay" id="viewFriendModal">
        <div class="modal-content" style="max-width: 400px; background: transparent; box-shadow: none; border: none;">
            <span class="close-modal" onclick="closeModal('viewFriendModal')" style="color: white; z-index: 2001;">√ó</span>
            <div class="wanted-poster">
                <div class="wanted-header">FRIEND</div>
                <img id="view-img" class="wanted-img" src="">
                <div id="view-name" class="wanted-name"></div>
                <div class="wanted-bounty">‡∏ø <span id="view-bounty" class="bounty-amount"></span></div>
                <div id="view-fruit" class="fruit-badge" style="display:none;"></div>
                <p id="view-bio" class="bio-text"></p>
                <div style="margin-top:10px; font-weight:bold;" id="view-status"></div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="editProfileModal">
        <div class="modal-content" style="max-width: 400px;">
            <span class="close-modal" onclick="closeModal('editProfileModal')">√ó</span>
            <h3>Profili D√ºzenle</h3>
            <div class="auth-form">
                <label>Yeni Hakkƒ±nda Yazƒ±sƒ±:</label><textarea id="edit-bio" rows="3"></textarea>
                <label>Yeni Resim Se√ß:</label><input type="file" id="edit-file" accept="image/*" onchange="previewEditImage()">
                <div style="text-align:center;"><img id="edit-preview" src="" style="width:80px;height:80px;border-radius:50%;margin:10px auto;border:2px solid #333;object-fit:cover;"></div>
                <button class="auth-btn" onclick="saveProfileEdit()">Kaydet</button>
            </div>
        </div>
    </div>

    <script type="module">
        // --- BURAYI FIREBASE'DEN ALDIƒûIN KODLARLA DEƒûƒ∞≈ûTƒ∞R ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, doc, setDoc, getDoc, updateDoc, arrayUnion, arrayRemove, onSnapshot, query, orderBy, limit } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // SENƒ∞N VERDƒ∞ƒûƒ∞N CONFIG BURADA
        const firebaseConfig = {
            apiKey: "AIzaSyAYQ1FVg9YwQTb8kuWIfg9KHiUIHBbkpqY",
            authDomain: "one-piece-haber.firebaseapp.com",
            projectId: "one-piece-haber",
            storageBucket: "one-piece-haber.firebasestorage.app",
            messagingSenderId: "292653018558",
            appId: "1:292653018558:web:e275236747771db3329def",
            measurementId: "G-G4NTRHD0YH"
        };

        // Firebase Ba≈ülatma
        let db;
        try {
            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            console.log("Firebase Baƒülandƒ±!");
        } catch(e) {
            console.error("Firebase Hatasƒ±:", e);
        }

        let currentUser = null;
        let uploadedImg = "https://static.wikia.nocookie.net/onepiece/images/c/c5/Revolutionary_Army_Jolly_Roger.png"; // Varsayƒ±lan
        let editImgTemp = "";

        // UI FONKSƒ∞YONLARI
        window.switchAuthMode = function(mode) {
            if(mode === 'login') {
                document.getElementById('login-form').style.display='block'; document.getElementById('register-form').style.display='none';
                document.getElementById('btn-show-login').classList.add('active'); document.getElementById('btn-show-register').classList.remove('active');
            } else {
                document.getElementById('login-form').style.display='none'; document.getElementById('register-form').style.display='block';
                document.getElementById('btn-show-login').classList.remove('active'); document.getElementById('btn-show-register').classList.add('active');
            }
        }

        window.previewImage = function() {
            const file = document.getElementById('reg-file').files[0];
            if(file){ const r=new FileReader(); r.onload=()=>{ uploadedImg=r.result; document.getElementById('img-preview').src=uploadedImg; document.getElementById('img-preview').style.display="block"; }; r.readAsDataURL(file); }
        }
        
        window.previewEditImage = function() {
            const file = document.getElementById('edit-file').files[0];
            if(file){ const r=new FileReader(); r.onload=()=>{ editImgTemp=r.result; document.getElementById('edit-preview').src=editImgTemp; }; r.readAsDataURL(file); }
        }

        // AUTH ƒ∞≈ûLEMLERƒ∞
        window.checkLogin = async function() {
            const saved = localStorage.getItem('op_user_v19');
            if(saved) {
                const tempUser = JSON.parse(saved);
                // Veritabanƒ±ndan en g√ºncel halini √ßek (ƒ∞stekler vb. i√ßin)
                if(db) {
                    const snap = await getDoc(doc(db, "users", tempUser.name));
                    if(snap.exists()) {
                        currentUser = snap.data();
                        localStorage.setItem('op_user_v19', JSON.stringify(currentUser));
                    }
                }
                
                const today = new Date().toDateString();
                if (currentUser.lastSpinDate !== today) { currentUser.spinsLeft = 3; currentUser.lastSpinDate = today; updateUserData(); }
                
                document.getElementById('auth-section').innerHTML = `<div class="user-profile-mini" onclick="openProfile()"><img src="${currentUser.avatar}" class="user-avatar-small"><span>${currentUser.name}</span></div>`;
                document.getElementById('spin-count').textContent = currentUser.spinsLeft;
                listenLeaderboard();
            }
        }

        window.performRegister = async function() {
            if(!db) return alert("Veritabanƒ± baƒülƒ± deƒüil!");
            const name = document.getElementById('reg-name').value.trim();
            const pass = document.getElementById('reg-pass').value;
            const bio = document.getElementById('reg-bio').value;
            if(!name || !pass) return alert("ƒ∞sim ve ≈üifre ≈üart!");

            const userRef = doc(db, "users", name);
            const snap = await getDoc(userRef);
            if(snap.exists()) return alert("Bu isimde bir korsan zaten var! Giri≈ü yap.");

            currentUser = { 
                name, pass, bio: bio || "Yeni Korsan", avatar: uploadedImg, 
                bounty: 1000, fruit: "Meyvesiz", fruitVal: 0, 
                spinsLeft: 3, lastSpinDate: new Date().toDateString(), 
                friends: [], friendRequests: [], isActive: true 
            };
            
            await setDoc(userRef, currentUser);
            localStorage.setItem('op_user_v19', JSON.stringify(currentUser));
            location.reload();
        }

        window.performLogin = async function() {
            if(!db) return alert("Veritabanƒ± baƒülƒ± deƒüil!");
            const name = document.getElementById('login-name').value.trim();
            const pass = document.getElementById('login-pass').value;
            
            const userRef = doc(db, "users", name);
            const snap = await getDoc(userRef);
            if(snap.exists() && snap.data().pass === pass) {
                currentUser = snap.data();
                currentUser.isActive = true; 
                if(!currentUser.friends) currentUser.friends = [];
                if(!currentUser.friendRequests) currentUser.friendRequests = [];
                
                await updateUserData();
                localStorage.setItem('op_user_v19', JSON.stringify(currentUser));
                location.reload();
            } else { alert("Hatalƒ± isim veya ≈üifre!"); }
        }

        window.performLogout = function() {
            if(currentUser) { currentUser.isActive = false; updateUserData(); }
            localStorage.removeItem('op_user_v19');
            location.reload();
        }

        // PROFƒ∞L D√úZENLEME
        window.enableEdit = function() {
            document.getElementById('edit-bio').value = currentUser.bio;
            document.getElementById('edit-preview').src = currentUser.avatar;
            editImgTemp = currentUser.avatar;
            closeModal('profileModal');
            document.getElementById('editProfileModal').style.display = 'flex';
        }

        window.saveProfileEdit = async function() {
            currentUser.bio = document.getElementById('edit-bio').value;
            currentUser.avatar = editImgTemp;
            await updateUserData();
            alert("Profil g√ºncellendi!");
            closeModal('editProfileModal');
            openProfile();
        }

        async function updateUserData() {
            if(!currentUser || !db) return;
            await setDoc(doc(db, "users", currentUser.name), currentUser);
            localStorage.setItem('op_user_v19', JSON.stringify(currentUser));
            if(document.getElementById('current-score')) document.getElementById('current-score').textContent = currentUser.bounty.toLocaleString();
        }

        // --- GELƒ∞≈ûMƒ∞≈û ARKADA≈û Sƒ∞STEMƒ∞ ---
        
        // 1. ƒ∞stek G√∂nder
        window.sendFriendRequest = async function() {
            const input = document.getElementById('friend-input');
            const targetName = input.value.trim();
            if(!targetName) return;
            if(targetName === currentUser.name) return alert("Kendini ekleyemezsin!");
            if(currentUser.friends.includes(targetName)) return alert("Zaten arkada≈üsƒ±nƒ±z!");

            const targetRef = doc(db, "users", targetName);
            const snap = await getDoc(targetRef);
            
            if(!snap.exists()) {
                alert("B√∂yle bir korsan bulunamadƒ±!");
            } else {
                const targetData = snap.data();
                // Zaten istek atmƒ±≈ü mƒ±yƒ±m?
                if(targetData.friendRequests && targetData.friendRequests.includes(currentUser.name)) {
                    return alert("Zaten istek g√∂nderilmi≈ü!");
                }
                
                // ƒ∞steƒüi kar≈üƒ± tarafa ekle
                await updateDoc(targetRef, {
                    friendRequests: arrayUnion(currentUser.name)
                });
                alert(targetName + " ki≈üisine istek g√∂nderildi!");
                input.value = "";
            }
        }

        // 2. ƒ∞stekleri ve Arkada≈ülarƒ± Listele
        async function renderFriendsAndRequests() {
            // Veriyi tazele
            const userSnap = await getDoc(doc(db, "users", currentUser.name));
            currentUser = userSnap.data();

            // ƒ∞stekler
            const reqList = document.getElementById('request-ul');
            if(!currentUser.friendRequests || !currentUser.friendRequests.length) {
                reqList.innerHTML = "<li>Gelen istek yok.</li>";
            } else {
                reqList.innerHTML = currentUser.friendRequests.map(req => `
                    <li>
                        <span>${req}</span>
                        <div class="friend-actions">
                            <button class="btn-tiny btn-accept" onclick="acceptRequest('${req}')">‚úì</button>
                            <button class="btn-tiny btn-decline" onclick="declineRequest('${req}')">‚úó</button>
                        </div>
                    </li>`).join('');
            }

            // Arkada≈ülar
            const friendList = document.getElementById('friend-ul');
            if(!currentUser.friends || !currentUser.friends.length) {
                friendList.innerHTML = "<li>Hen√ºz kimse yok...</li>";
            } else {
                friendList.innerHTML = currentUser.friends.map(f => `
                    <li>
                        <span onclick="viewFriendProfile('${f}')" style="flex-grow:1;">‚ò†Ô∏è ${f}</span>
                        <button class="btn-tiny btn-remove" onclick="removeFriend('${f}')">üóëÔ∏è</button>
                    </li>`).join('');
            }
        }

        // 3. ƒ∞steƒüi Kabul Et
        window.acceptRequest = async function(requesterName) {
            // Beni g√ºncelle: ƒ∞steƒüi sil, arkada≈üa ekle
            await updateDoc(doc(db, "users", currentUser.name), {
                friendRequests: arrayRemove(requesterName),
                friends: arrayUnion(requesterName)
            });
            // Onu g√ºncelle: Beni arkada≈üa ekle
            await updateDoc(doc(db, "users", requesterName), {
                friends: arrayUnion(currentUser.name)
            });
            alert(requesterName + " ile artƒ±k tayfasƒ±nƒ±z!");
            renderFriendsAndRequests();
        }

        // 4. ƒ∞steƒüi Reddet
        window.declineRequest = async function(requesterName) {
            await updateDoc(doc(db, "users", currentUser.name), {
                friendRequests: arrayRemove(requesterName)
            });
            renderFriendsAndRequests();
        }

        // 5. Arkada≈üƒ± Sil (Kar≈üƒ±lƒ±klƒ±)
        window.removeFriend = async function(friendName) {
            if(!confirm(friendName + " tayfadan atƒ±lsƒ±n mƒ±?")) return;
            
            // Benden sil
            await updateDoc(doc(db, "users", currentUser.name), {
                friends: arrayRemove(friendName)
            });
            // Ondan sil
            await updateDoc(doc(db, "users", friendName), {
                friends: arrayRemove(currentUser.name)
            });
            
            renderFriendsAndRequests();
        }

        // PROFƒ∞L A√áMA (G√úNCELLENDƒ∞)
        window.openProfile = function() {
            if(!currentUser) return;
            document.getElementById('profile-name').textContent = currentUser.name;
            document.getElementById('profile-img').src = currentUser.avatar;
            document.getElementById('profile-bounty').textContent = currentUser.bounty.toLocaleString();
            document.getElementById('profile-bio').textContent = currentUser.bio;
            const fb = document.getElementById('profile-fruit');
            if(currentUser.fruit && currentUser.fruit !== "Meyvesiz") { fb.textContent = "Meyve: " + currentUser.fruit; fb.style.display="inline-block"; } else { fb.style.display="none"; }
            
            renderFriendsAndRequests(); // Yeni fonksiyonu √ßaƒüƒ±r
            document.getElementById('profileModal').style.display='flex';
        }

        window.viewFriendProfile = async function(name) {
            const ref = doc(db, "users", name);
            const snap = await getDoc(ref);
            if(snap.exists()) {
                const u = snap.data();
                document.getElementById('view-name').textContent = u.name;
                document.getElementById('view-img').src = u.avatar;
                document.getElementById('view-bounty').textContent = u.bounty.toLocaleString();
                document.getElementById('view-bio').textContent = u.bio;
                const vf = document.getElementById('view-fruit');
                if(u.fruit && u.fruit!=="Meyvesiz") { vf.textContent=u.fruit; vf.style.display="inline-block"; } else { vf.style.display="none"; }
                
                const stat = document.getElementById('view-status');
                stat.textContent = u.isActive ? "üü¢ ≈ûu an Aktif" : "üî¥ Pasif";
                stat.style.color = u.isActive ? "green" : "red";
                
                closeModal('profileModal');
                document.getElementById('viewFriendModal').style.display='flex';
            }
        }

        // LEADERBOARD
        function listenLeaderboard() {
            if(!db) return;
            const q = query(collection(db, "users"), orderBy("bounty", "desc"), limit(50));
            onSnapshot(q, (snapshot) => {
                const tbody = document.getElementById('leaderboard-body');
                tbody.innerHTML = "";
                let rank = 1;
                snapshot.forEach((doc) => {
                    const u = doc.data();
                    const isMe = currentUser && currentUser.name === u.name ? 'current-user-row' : '';
                    tbody.innerHTML += `<tr class="${isMe}"><td>${rank++}</td><td>${u.name}</td><td>${u.bounty.toLocaleString()} ‡∏ø</td><td>${u.fruit || '-'}</td></tr>`;
                });
            });
        }

        // √áARK Sƒ∞STEMƒ∞
        const fruitList = [
            {n:"Hito Hito: Nika", v:3000000000, c:0.01}, 
            {n:"Gura Gura no Mi", v:1500000000, c:0.03}, 
            {n:"Ope Ope no Mi", v:1000000000, c:0.05},
            {n:"Mera Mera no Mi", v:500000000, c:0.10},
            {n:"Gomu Gomu (Normal)", v:100000000, c:0.20},
            {n:"Bara Bara no Mi", v:15000000, c:0.30},
            {n:"Sube Sube no Mi", v:5000000, c:0.31}
        ];

        window.spinFruit = function() {
            if(!currentUser) return alert("√ñnce giri≈ü yap!");
            if(currentUser.spinsLeft <= 0) return alert("Bug√ºnl√ºk hakkƒ±n bitti!");
            
            currentUser.spinsLeft--;
            document.querySelector('.spin-limit').innerHTML = `Kalan: ${currentUser.spinsLeft}`;
            document.getElementById('fruit-display').style.transform = "rotate(1080deg)";
            
            setTimeout(async () => {
                const rand = Math.random();
                let cumulative = 0;
                let selected = fruitList[fruitList.length-1];
                for(let f of fruitList) { cumulative += f.c; if(rand <= cumulative) { selected = f; break; } }
                
                if(currentUser.fruitVal > 0) currentUser.bounty -= currentUser.fruitVal;
                currentUser.fruit = selected.n;
                currentUser.fruitVal = selected.v;
                currentUser.bounty += selected.v;
                if(currentUser.bounty < 0) currentUser.bounty = 0;
                
                await updateUserData();
                document.getElementById('fruit-display').innerHTML = `<div class="fruit-name">${selected.n}</div><div class="fruit-desc">+${selected.v.toLocaleString()}</div>`;
                document.getElementById('fruit-display').style.transform = "rotate(0deg)";
            }, 1000);
        }

        // QUIZ (40 SORU - RASTGELE 10)
        const allQ = [
            {q:"Luffy‚Äônin ≈üeytan meyvesinin ger√ßek adƒ± nedir?", a:["Gomu Gomu no Mi","Hito Hito no Mi","Hito Hito no Mi, Model: Nika","Nika Nika no Mi"], c:2},
            {q:"Zoro‚Äônun ustasƒ±nƒ±n adƒ± nedir?", a:["Mihawk","Koshiro","Rayleigh","Oden"], c:1},
            {q:"Sanji hangi denizde doƒümu≈ütur?", a:["West Blue","North Blue","South Blue","East Blue"], c:1},
            {q:"Nami‚Äônin ilk baƒülƒ± olduƒüu korsan kimdi?", a:["Arlong","Buggy","Crocodile","Don Krieg"], c:0},
            {q:"Usopp‚Äôun babasƒ±nƒ±n adƒ± nedir?", a:["Yasopp","Beckman","Lucky Roo","Shanks"], c:0},
            {q:"Tony Tony Chopper hangi meyveyi yemi≈ütir?", a:["Gomu Gomu no Mi","Hito Hito no Mi","Mera Mera no Mi","Ushi Ushi no Mi"], c:1},
            {q:"Nico Robin‚Äôin ilk √∂rg√ºt√º hangisidir?", a:["CP9","Baroque Works","Donquixote Ailesi","Devrim Ordusu"], c:1},
            {q:"Franky‚Äônin ger√ßek adƒ± nedir?", a:["Iceburg","Cutty Flam","Tom","Paulie"], c:1},
            {q:"Brook ka√ß yƒ±l boyunca tek ba≈üƒ±na denizde kalmƒ±≈ütƒ±r?", a:["10","20","30","50"], c:3},
            {q:"Jinbe hangi ƒ±rktandƒ±r?", a:["Dev","Mink","Balƒ±k Adam","Lunarian"], c:2},
            {q:"Luffy ilk olarak hangi denizde yola √ßƒ±ktƒ±?", a:["Grand Line","East Blue","West Blue","North Blue"], c:1},
            {q:"Shanks hangi Yonko grubundadƒ±r?", a:["Beyazsakal Korsanlarƒ±","Big Mom Korsanlarƒ±","Kƒ±zƒ±l Sa√ß Korsanlarƒ±","Kara Sakal Korsanlarƒ±"], c:2},
            {q:"Portgas D. Ace‚Äôin ≈üeytan meyvesi nedir?", a:["Magu Magu no Mi","Mera Mera no Mi","Gura Gura no Mi","Suna Suna no Mi"], c:1},
            {q:"Whitebeard‚Äôƒ±n ger√ßek adƒ± nedir?", a:["Edward Teach","Edward Newgate","Rocks D. Xebec","Marshall D. Teach"], c:1},
            {q:"Enies Lobby‚Äôde Straw Hat‚Äôlere kar≈üƒ± sava≈üan CP9 lideri kimdi?", a:["Kaku","Jabra","Lucci","Spandam"], c:2},
            {q:"Doflamingo hangi krallƒ±ƒüƒ±n eski prensi?", a:["Alabasta","Dressrosa","Wano","Drum"], c:1},
            {q:"Wano‚Äônun eski shogunu kimdi?", a:["Orochi","Oden","Kaido","Momonosuke"], c:1},
            {q:"Kaido hangi meyveye sahiptir?", a:["Ryu Ryu no Mi","Uo Uo no Mi, Model: Seiryu","Hebi Hebi no Mi","Tori Tori no Mi"], c:1},
            {q:"Big Mom‚Äôun ger√ßek adƒ± nedir?", a:["Charlotte Smoothie","Charlotte Linlin","Streusen","Perospero"], c:1},
            {q:"Trafalgar Law‚Äôun meyvesi nedir?", a:["Ope Ope no Mi","Ito Ito no Mi","Yami Yami no Mi","Bari Bari no Mi"], c:0},
            {q:"Blackbeard ka√ß ≈üeytan meyvesi g√ºc√ºne sahiptir?", a:["1","2","3","4"], c:1},
            {q:"Gol D. Roger‚Äôƒ±n lakabƒ± nedir?", a:["Altƒ±n Aslan","Korsan Kral","Deniz ≈ûeytanƒ±","Efsanevi Kƒ±lƒ±√ß Ustasƒ±"], c:1},
            {q:"One Piece hazinesinin bulunduƒüu ada?", a:["Raftel","Laugh Tale","Lodestar","Elbaf"], c:1},
            {q:"Sabo hangi √∂rg√ºt√ºn √ºyesidir?", a:["CP0","Devrim Ordusu","Marine","Baroque Works"], c:1},
            {q:"Monkey D. Dragon kimdir?", a:["Amiral","Yonko","Devrim Ordusu lideri","Shichibukai"], c:2},
            {q:"En g√º√ßl√º denizci unvanƒ± nedir?", a:["Koramiral","Filo Amiral","Amiral","Y√ºzba≈üƒ±"], c:1},
            {q:"Luffy‚Äônin Gear 2 tekniƒüini ilk kullandƒ±ƒüƒ± yer?", a:["Alabasta","Enies Lobby","Thriller Bark","Marineford"], c:1},
            {q:"Zoro‚Äônun ‚ÄúEnma‚Äù kƒ±lƒ±cƒ± nereden gelmi≈ütir?", a:["Mihawk","Wano","East Blue","Marine"], c:1},
            {q:"Shichibukai sistemi ka√ß √ºyeden olu≈üur?", a:["5","6","7","8"], c:2},
            {q:"Akainu‚Äônun meyvesi nedir?", a:["Mera Mera no Mi","Magu Magu no Mi","Hie Hie no Mi","Pika Pika no Mi"], c:1},
            {q:"Aokiji‚Äônin meyvesi nedir?", a:["Hie Hie no Mi","Moku Moku no Mi","Suna Suna no Mi","Yami Yami no Mi"], c:0},
            {q:"Kizaru‚Äônun meyvesi nedir?", a:["Pika Pika no Mi","Magu Magu no Mi","Ope Ope no Mi","Goro Goro no Mi"], c:0},
            {q:"Enel hangi adada ya≈üƒ±yordu?", a:["Skypiea","Dressrosa","Fishman Island","Zou"], c:0},
            {q:"Crocodile‚Äôƒ±n meyvesi nedir?", a:["Suna Suna no Mi","Ito Ito no Mi","Gura Gura no Mi","Doku Doku no Mi"], c:0},
            {q:"Bartholomew Kuma‚Äônƒ±n meyvesi nedir?", a:["Paw Paw (Nikyu Nikyu no Mi)","Bari Bari no Mi","Hobi Hobi no Mi","Hana Hana no Mi"], c:0},
            {q:"Mihawk‚Äôƒ±n lakabƒ± nedir?", a:["Denizlerin ƒ∞mparatoru","En G√º√ßl√º Kƒ±lƒ±√ß Ustasƒ±","Kara ≈û√∂valye","Kƒ±zƒ±l ≈ûahin"], c:1},
            {q:"Wano √ºlkesinin kapalƒ± kalmasƒ±nƒ±n sebebi nedir?", a:["D√ºnya H√ºk√ºmeti korkusu","Antik silah","Geleneksel izolasyon politikasƒ±","Deniz ta≈ülarƒ±"], c:2},
            {q:"Joy Boy ismi ilk nerede duyuldu?", a:["Marineford","Fishman Island","Dressrosa","Alabasta"], c:1},
            {q:"Luffy‚Äônin babasƒ± kimdir?", a:["Garp","Dragon","Roger","Shanks"], c:1},
            {q:"Straw Hat‚Äôlerin gemisinin adƒ± nedir?", a:["Going Merry","Thousand Sunny","Red Force","Moby Dick"], c:1}
        ];
        
        let quizQ=[], qIdx=0;
        function initQuiz(){ quizQ = [...allQ].sort(()=>0.5-Math.random()).slice(0,10); qIdx=0; loadQ(); }
        function loadQ(){
            if(qIdx>=quizQ.length){ document.getElementById('quiz-box').innerHTML=`<p>Bitti! (Puanlar Eklendi)</p><button class='quiz-btn' onclick='location.reload()'>Tekrar</button>`; return; }
            const q = quizQ[qIdx];
            document.getElementById('question-text').textContent = (qIdx+1)+". "+q.q;
            document.querySelectorAll('.quiz-btn').forEach((b,i)=>{ b.textContent=q.a[i]; b.disabled=false; b.style.background="var(--bg-dark)"; });
        }
        window.checkAnswer = async function(i){
            if(i===quizQ[qIdx].c){
                if(currentUser){ currentUser.bounty+=5000; await updateUserData(); }
                document.getElementById('feedback-text').textContent="Doƒüru! (+5000)";
            } else { document.getElementById('feedback-text').textContent="Yanlƒ±≈ü!"; }
            qIdx++; setTimeout(loadQ, 800);
        }

        // --- Dƒ∞ƒûER ---
        const contents = {
            'manga': `<h2>üö® √ñnemliler (En Sƒ±cak Geli≈ümeler)</h2><h3>1. Manga: B√∂l√ºm 1174 ve "B√ºy√ºk Mola"</h3><p><strong>G√ºncel Durum:</strong> Manga ≈üu an Elbaf Arkƒ±'nƒ±n zirvesinde. ƒ∞nternetteki son raporlara g√∂re 1174. B√∂l√ºm'√ºn yarƒ±n (15 ≈ûubat 2026) yayƒ±nlanmasƒ± bekleniyor.</p><p><strong>K√∂t√º Haber (Ara):</strong> 1174. b√∂l√ºmden sonra Eiichiro Oda'nƒ±n klasik "3 b√∂l√ºm √ßiz, 1 hafta ara ver" rutini devreye girecek. Yani 22 ≈ûubat haftasƒ± manga yok.</p><p><strong>D√∂n√º≈ü:</strong> Seri, 1 Mart 2026'da 1175. B√∂l√ºm ile geri d√∂necek.</p><p><strong>B√ºy√ºk Olay (Spoiler ƒ∞√ßerebilir):</strong> ƒ∞nternetteki sƒ±zƒ±ntƒ±lar ve tartƒ±≈ümalar, 1175. b√∂l√ºm√ºn serinin en b√ºy√ºk sava≈ülarƒ±ndan birine, Luffy vs. Imu kar≈üƒ±la≈ümasƒ±na sahne olacaƒüƒ±nƒ± (veya bu sava≈üƒ±n kƒ±zƒ±≈üacaƒüƒ±nƒ±) i≈üaret ediyor.</p><h3>2. Live Action (2. Sezon): Tarih Kesinle≈üti!</h3><p><strong>Yayƒ±n Tarihi:</strong> Netflix, One Piece Live Action 2. Sezon'un 10 Mart 2026'da yayƒ±nlanacaƒüƒ±nƒ± doƒüruladƒ±. Yani 1 aydan az bir s√ºre kaldƒ±.</p><p><strong>Kapsam:</strong> Bu sezon Loguetown ile ba≈ülayƒ±p, Drum Adasƒ±'na kadar gidecek (Alabasta muhtemelen 3. sezona saklandƒ±).</p><p><strong>3. Sezon Onayƒ±:</strong> ≈ûimdiden 3. sezon onayƒ± alƒ±ndƒ±ƒüƒ± ve √ßekimlerin (√∂zellikle Alabasta kƒ±sƒ±mlarƒ± i√ßin) ba≈üladƒ±ƒüƒ±na dair g√º√ßl√º haberler var.</p><p><strong>Kadro:</strong> Smoker (Callum Kerr) ve Tashigi (Julia Rehwald) gibi karakterler fragmanlarda g√∂r√ºnd√º. Tony Tony Chopper'ƒ±n CGI/Makyaj karƒ±≈üƒ±mƒ± g√∂r√ºn√ºm√º b√ºy√ºk merak konusu.</p><h3>üî• √ñne √áƒ±kanlar (Detaylar & Yan Projeler)</h3><p><strong>1. Anime (Wit Studio Remake): Sessizlik S√ºr√ºyor</strong><br>Netflix ve Wit Studio'nun (Attack on Titan'ƒ±n ilk st√ºdyosu) hazƒ±rladƒ±ƒüƒ± "THE ONE PIECE" yeniden yapƒ±mƒ± (remake) i√ßin Jump Festa 2026'da beklenen fragman gelmedi. Proje "yapƒ±m a≈üamasƒ±nda" denilerek ge√ßi≈ütirildi. ƒ∞nternetteki genel kanƒ±, projenin beklenenden yava≈ü ilerlediƒüi y√∂n√ºnde.</p><p><strong>2. Mevcut Anime (Toei Animation)</strong><br>Orijinal anime serisi de manga ile paralel olarak Elbaf d√∂nemine giri≈ü yapmƒ±≈ü durumda (veya Egghead'in finalini i≈üliyor, takvime g√∂re deƒüi≈üebilir). Ancak manga ≈üu an √ßok kritik bir sava≈üta olduƒüu i√ßin t√ºm g√∂zler okuyucularda.</p><h3>üîÆ Hayranlara G√∂re √ñn√ºm√ºzdeki B√∂l√ºmler & Teoriler</h3><p><strong>Luffy vs. Imu (B√∂l√ºm 1175+):</strong><br>Hayranlar, 1 Mart'ta gelecek 1175. b√∂l√ºm√ºn, Luffy'nin "G√ºne≈ü Tanrƒ±sƒ± Nika" formu ile Imu arasƒ±ndaki doƒürudan √ßatƒ±≈ümanƒ±n ba≈ülangƒ±cƒ± olacaƒüƒ±na inanƒ±yor. Bu, serinin finaline giden en net yol olarak g√∂r√ºl√ºyor. Bir diƒüer teori, Elbaf'taki Devlerin bu sava≈üta Luffy'ye nasƒ±l bir ordu desteƒüi vereceƒüi √ºzerine.</p><p><strong>Shanks'ƒ±n Hamlesi:</strong><br>Elbaf, Shanks'ƒ±n b√∂lgesi olduƒüu i√ßin, hayranlar Shanks'ƒ±n Luffy ile Imu arasƒ±ndaki sava≈üa m√ºdahil olmasƒ±nƒ± veya "One Piece"i almak i√ßin son hamlesini yapmasƒ±nƒ± bekliyor. "Davy Back Fight" teorileri veya "Son Poneglyph"in konumu hakkƒ±nda spek√ºlasyonlar zirvede.</p><p><strong>Live Action Chopper:</strong><br>10 Mart'taki pr√∂miyer √∂ncesi en b√ºy√ºk korku ve merak Chopper. Dedektif Pikachu tarzƒ± ger√ßek√ßi bir yakla≈üƒ±m mƒ± yoksa daha maskotvari bir yakla≈üƒ±m mƒ± olduƒüu hala en √ßok tartƒ±≈üƒ±lan konu.</p>`,
            'sbs': `<h2>SBS (Soru-Cevap K√∂≈üesi)</h2><p>Bu SBS'ler genellikle karakterlerin ki≈üisel √∂zelliklerini tanƒ±mlar ve hayranlar arasƒ±nda "canon" (resmi) bilgi kabul edilir.</p><h3>Eƒüer Hasƒ±r ≈ûapkalar Ger√ßek D√ºnyada Ya≈üasaydƒ± (Cilt 56)</h3><p><strong>Okuyucu (D):</strong> Oda-sensei! Luffy ve diƒüerleri ger√ßek hayatta olsalardƒ± hangi √ºlkeden olurlardƒ±?</p><p><strong>Oda (O):</strong> Karakterlerin g√∂r√ºn√º≈ülerine ve imajlarƒ±na dayanarak ≈ü√∂yle olurdu:<br>Luffy: Brezilya<br>Zoro: Japonya<br>Nami: ƒ∞sve√ß<br>Usopp: Afrika (Kƒ±ta olarak belirtmi≈ü)<br>Sanji: Fransa<br>Chopper: Kanada<br>Robin: Rusya<br>Franky: ABD<br>Brook: Avusturya<br>(Not: Jinbe daha sonra eklendiƒüinde onun i√ßin "Hindistan" demi≈ütir.)</p><h3>Banyo Yapma Sƒ±klƒ±klarƒ± (Cilt 48)</h3><p><strong>D:</strong> Merak ediyorum, Hasƒ±r ≈ûapka Korsanlarƒ± ne sƒ±klƒ±kla banyo yapƒ±yor?</p><p><strong>O:</strong> Bu soru √ßok geliyor. ƒ∞≈üte cevaplar:<br>Luffy, Zoro, Brook: Haftada 1 kez.<br>Usopp, Franky, Chopper: 3 g√ºnde 1 kez.<br>Sanji, Nami, Robin: Her g√ºn.<br><strong>Oda'nƒ±n notu:</strong> Sanji her g√ºn yƒ±kanƒ±r √ß√ºnk√º kadƒ±nlarƒ±n yanƒ±na temiz gitmek ister. Erkeklerin olduƒüu g√ºnler "erkekler g√ºn√º" gibi toplu yƒ±kanƒ±rlar ve tam bir kaos ortamƒ± olur. Chopper genelde kadƒ±nlarla yƒ±kanƒ±r √ß√ºnk√º erkekler √ßok vah≈üi davranƒ±r.</p><h3>‚öîÔ∏è Karakter Detaylarƒ± ve Sƒ±rlar</h3><p><strong>Zoro'nun Kƒ±lƒ±√ßlarƒ±nƒ± Aƒüzƒ±yla Tutmasƒ± (Cilt 5)</strong><br>D: Zoro konu≈üurken kƒ±lƒ±cƒ± aƒüzƒ±nda tutuyor. Di≈üleri aƒürƒ±mƒ±yor mu? Nasƒ±l konu≈üabiliyor?<br>O: O, kalbiyle konu≈üuyor! (≈ûaka bir yana, bu bir manga, √ßok takƒ±lmayƒ±n ama evet, √ßenesi √ßok g√º√ßl√º.)</p><p><strong>Sanji'nin Ka≈ülarƒ± (Cilt 7)</strong><br>D: Sanji'nin ka≈üƒ± neden kƒ±vrƒ±k?<br>O: Hey! Dur orada! O ka≈ü hakkƒ±nda ≈üaka yapma! O ka≈üƒ±n kƒ±vrƒ±mƒ±, evrenin enerjisini i√ßinde barƒ±ndƒ±rƒ±r. Eƒüer o kƒ±vrƒ±m d√ºzle≈üirse d√ºnya yok olabilir... ≈ûaka ≈üaka. Sadece tasarƒ±mƒ± ho≈üuma gidiyor.</p><p><strong>Nami'nin Kƒ±yafetleri (Cilt 20 civarƒ±)</strong><br>D: Nami neden hep bu kadar a√ßƒ±k giyiniyor?<br>O: √á√ºnk√º modayƒ± seviyor! Ayrƒ±ca... √áizmesi daha eƒülenceli deƒüil mi? (Oda'nƒ±n klasik sapƒ±k ≈üakalarƒ±).</p><h3>üçé ≈ûeytan Meyveleri Hakkƒ±nda</h3><p><strong>ƒ∞nsan ƒ∞nsan Meyvesi (Hito Hito no Mi) (Cilt 20)</strong><br>D: Chopper "Hito Hito no Mi" yedi ve insan-geyik oldu. Peki ya bir insan bu meyveyi yerse ne olur?<br>O: Sanƒ±rƒ±m "Aydƒ±nlanmƒ±≈ü ƒ∞nsan" olurdu. Nirvana'ya ula≈ümƒ±≈ü, kendini bulmu≈ü bir insan... Ya da sadece y√ºzmesi imkansƒ±z hale gelen normal bir insan. (Oda burada Luffy'nin meyvesiyle ilgili ger√ßeƒüi yƒ±llar √∂ncesinden saklƒ±yordu).</p><p><strong>Luffy'nin Uzamasƒ± (√áe≈üitli Ciltler)</strong><br>D: Luffy'nin v√ºcudu lastik olduƒüu i√ßin... ≈ûeyi de uzuyor mu?<br>O: Evet. (Net ve kƒ±sa cevap).</p><h3>üë¥ Karakterlerin Gelecekteki Halleri</h3><p>Oda, son zamanlarda SBS'lerde karakterlerin "ƒ∞≈üler yolunda giderse" ve "ƒ∞≈üler k√∂t√º giderse" 40 ve 60 ya≈üƒ±ndaki hallerini √ßiziyor.</p><p><strong>Luffy'nin Geleceƒüi (Cilt 89)</strong><br>40 Ya≈ü (ƒ∞yi Yol): "Et!! Yine mi et yiyoruz? ≈ûahane!" (Shanks'a benziyor).<br>60 Ya≈ü (ƒ∞yi Yol): "Korsanlar Kralƒ± mƒ±? Evet, o benim." (Garp'a benziyor).<br>40 Ya≈ü (K√∂t√º Yol): "Korsanlar Kralƒ± mƒ±? R√ºya g√∂rmeyi bƒ±rak." (≈ûi≈üman ve bakƒ±msƒ±z).<br>60 Ya≈ü (K√∂t√º Yol): "Hey, bana biraz et versene, bor√ß yaz." (Di≈üleri d√∂k√ºlm√º≈ü).</p><p><strong>Ace'in Geleceƒüi (Eƒüer √∂lmeseydi - Cilt 89)</strong><br>O: Eƒüer hayatta kalsaydƒ± b√∂yle g√∂r√ºn√ºrd√º... (Oda burada Ace'in ya≈ülanmƒ±≈ü, olgun ve Beyazbƒ±yƒ±k'a sadƒ±k, g√º√ßl√º bir korsan halini √ßizdi. Hayranlarƒ± aƒülatan bir SBS'dir.)</p><h3>ü§™ Komik ve Meta Sorular</h3><p><strong>Beyazbƒ±yƒ±k'ƒ±n Bƒ±yƒ±ƒüƒ± mƒ± Yoksa... (Cilt 39)</strong><br>D: Beyazbƒ±yƒ±k'ƒ±n (Whitebeard) y√ºz√ºndeki o ≈üey... O bir bƒ±yƒ±k mƒ± yoksa burnundan √ßƒ±kan kƒ±llar mƒ±?<br>O: Ne kadar kaba! O ≈üanlƒ± bir bƒ±yƒ±k! Aslƒ±nda o bir bumerang! Sava≈üta yerinden √ßƒ±karƒ±p fƒ±rlatƒ±yor ve geri d√∂n√ºp tekrar yapƒ±≈üƒ±yor! (Tabii ki yalan s√∂yl√ºyor).</p><p><strong>Karakterlerin Beyin Yapƒ±sƒ± (Cilt 50 civarƒ±)</strong><br>D: Hasƒ±r ≈ûapkalarƒ±n beyninin i√ßinde ne var?<br>O:<br>Luffy: Et, Et, Et, Et, Korsanlar Kralƒ±.<br>Zoro: Kƒ±lƒ±√ß, Kƒ±lƒ±√ß, G√º√ß, Uyku, Sake.<br>Nami: Para, Para, Para, G√ºzellik, Para.<br>Sanji: Kadƒ±nlar, Yemek, Kadƒ±nlar, Nami-san, Robin-chan.<br>Chopper: Doktorluk, ƒ∞la√ß, Tatlƒ±, Pamuk ≈ûeker.</p><h3>üó°Ô∏è Nesnelerin ƒ∞nsanla≈ütƒ±rƒ±lmasƒ±</h3><p><strong>Zoro'nun Kƒ±lƒ±√ßlarƒ± ƒ∞nsan Olsaydƒ± (Cilt 92)</strong><br>D: Zoro'nun kƒ±lƒ±√ßlarƒ± (Wado Ichimonji, Sandai Kitetsu, Shusui) insan olsaydƒ± nasƒ±l g√∂r√ºn√ºrd√º?<br>O:<br>Wado Ichimonji: Ciddi, geleneksel kƒ±yafetli, onurlu bir adam.<br>Sandai Kitetsu: Sapkƒ±n, korkun√ß g√∂r√ºn√ºml√º, lanetli bir serseri.<br>Shusui: Sava≈ü√ßƒ± ruhlu, g√º√ßl√º ama biraz kaba bir samuray.</p><h3>‚ùì SBS Nasƒ±l Ba≈ülar ve Biter?</h3><p>SBS'nin en b√ºy√ºk kuralƒ±, okuyucunun k√∂≈üeyi ba≈ülatmaya √ßalƒ±≈ümasƒ± ve Oda'nƒ±n bunu engellemeye √ßalƒ±≈ümasƒ±dƒ±r (veya tam tersi).<br>√ñrnek (Neredeyse her cilt):<br>D: "SBS Ba≈ülƒ±y..."<br>O: "BA≈ûLAMIYOR!"<br>√ñrnek (Cilt 4):<br>D: "L√ºtfen SBS'yi ba≈ülatmama izin verin."<br>O: "Pekala, ba≈ülayƒ±n."<br>D: "SBS BA≈ûLADI!"<br>O: "Hah! Ben ba≈ülatacaktƒ±m!"</p>`,
            'anime': `<h2>Anime & Remake G√ºncellemesi</h2><p><strong>Mevcut Anime (Toei Animation):</strong> Orijinal anime serisi de manga ile paralel olarak Elbaf d√∂nemine giri≈ü yapmƒ±≈ü durumda. Ancak manga ≈üu an √ßok kritik bir sava≈üta olduƒüu i√ßin t√ºm g√∂zler okuyucularda.</p><p><strong>Wit Studio Remake:</strong> Sessizlik s√ºr√ºyor. Jump Festa 2026'da beklenen fragman gelmedi. Proje "yapƒ±m a≈üamasƒ±nda" denilerek ge√ßi≈ütirildi. ƒ∞nternetteki genel kanƒ±, projenin beklenenden yava≈ü ilerlediƒüi y√∂n√ºnde.</p>`
        };

        window.openModal = function(key) { document.getElementById('modalBody').innerHTML = contents[key]; document.getElementById('infoModal').style.display='flex'; }
        window.closeModal = function(id) { document.getElementById(id || 'infoModal').style.display='none'; }
        window.openLoginModal = function() { document.getElementById('loginModal').style.display='flex'; }
        window.onclick = function(e) { if(e.target.classList.contains('modal-overlay')) e.target.style.display='none'; }

        // Anime Sayacƒ±
        setInterval(()=>{
            const now = new Date();
            const animeDate = new Date("2026-04-01T00:00:00");
            const diff = Math.ceil((animeDate - now) / (1000*60*60*24));
            document.getElementById('anime-timer').textContent = diff > 0 ? diff + " g√ºn" : "Yayƒ±nda!";
            
            const mangaDate = new Date(); mangaDate.setDate(now.getDate() + (4 + 7 - now.getDay()) % 7);
            const d = Math.floor((mangaDate-now)/(1000*60*60*24));
            document.getElementById('manga-timer').textContent = d + " g√ºn";
            document.getElementById('la-timer').textContent = Math.ceil((new Date("2026-03-10") - now)/(1000*60*60*24)) + " g√ºn";
        }, 1000);

        checkLogin(); initQuiz();
        listenLeaderboard();
    </script>
</body>
</html>
